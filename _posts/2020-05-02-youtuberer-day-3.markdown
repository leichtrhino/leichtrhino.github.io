---
layout: post
title:  "あつまれ YouTuberのデータ その3"
date:   2020-05-02 06:00:00 +0900
mathjax: true
published: false
---

[前回]({% post_url 2020-05-01-youtuberer-day-2 %})

今日は収集したデータを集計し、次の行動を決めます。 ちなみにこれは`rmarkdown`を用いて作成しています。
ソースコードは[こちら](https://github.com/leichtrhino/leichtrhino.github.io/tree/master/assets/Rmd/2020-05-02-youtuberer-day-3.Rmd)

### 使用ライブラリ、データの読み込み

次のライブラリを読み込みます。 最後の部分は`ggplot`の設定です。

``` r
library(readr)
library(dplyr)
library(tidyr)
library(forcats)
library(ggplot2)
library(viridis)
library(knitr)
theme_set(theme_light(base_size = 12, base_family = 'IPAexGothic'))
```

以下のデータを読み込み、テーブルの結合を行います。

``` r
categories <- read_csv('categories.csv') %>%
    rename(cattitle = title)
```

    ## Parsed with column specification:
    ## cols(
    ##   id = col_double(),
    ##   title = col_character()
    ## )

``` r
data <- read_csv('contain-face.csv') %>%
    left_join(categories, by = c('catid' = 'id')) %>%
    mutate(cattitle = fct_reorder(cattitle, catid))
```

    ## Parsed with column specification:
    ## cols(
    ##   time = col_character(),
    ##   scatid = col_double(),
    ##   rank = col_double(),
    ##   id = col_character(),
    ##   cid = col_character(),
    ##   catid = col_double(),
    ##   title = col_character(),
    ##   ctitle = col_character(),
    ##   nfaces = col_double()
    ## )

### 基本的な集計

トレンドに載っていた動画は3060本、 チャンネルの総数は1873です。

次の図はカテゴリごとの動画の本数を表します。

``` r
data %>%
    select(-c(time, scatid, rank)) %>% # 同一の動画の除去
    distinct() %>%
    ggplot(aes(x=cattitle)) +
    geom_bar() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
```

![](/assets/img/youtuberer/day-3-fig-1-1.png)<!-- -->

### 特定カテゴリの人気の動画

各カテゴリの人気の動画を見ていきましょう。 次のコードによってカテゴリ名`Entertainment`で上位5個に
入ったことがある動画およびそのチャンネル名、最も上位のランクを表示します。
なお、“上位”について、`Data API`で得られた結果に基づき求めているので、
必ずしも正確なデータではありません。ご留意ください。

``` r
data %>%
    filter(cattitle == 'Entertainment') %>%
    group_by(id) %>%
    summarise(minrank = min(rank)) %>%
    filter(minrank <= filter_rank) %>% # filter_rank: 本文中にこっそり定義されています
    inner_join(
        data %>% select(c(id, title, ctitle)) %>% distinct(),
        by = c('id' = 'id')
    ) %>%
    arrange(minrank) %>%
    select(c(minrank, title, ctitle)) %>%
    kable
```

| minrank | title                                                                   | ctitle                           |
| ------: | :---------------------------------------------------------------------- | :------------------------------- |
|       1 | チクワとレックスが初めて会ったらどうなるの！？                                                 | Fischer’s-フィッシャーズ-               |
|       1 | 【あつ森】島全部ベルで埋めるのにいくらかかるの？？？                                              | はじめしゃちょーの畑                       |
|       1 | チワワと一緒にドミノ100個を並べたら何時間かかるの？                                             | Fischer’s-フィッシャーズ-               |
|       1 | 【公式】志村けんのだいじょうぶだぁ ＃１                                                    | IZAWA OFFICE / イザワオフィス           |
|       1 | 行き場を失ってしまった『高級伊勢海老』が破格で売られてる。値段がマジでヤバすぎる                                | きまぐれクックKimagure Cook             |
|       1 | 【あつ森】○○億ベルかかりました                                                       | はじめしゃちょーの畑                       |
|       1 | 東京03 - 「この時間」 ／ 『第14回東京03単独公演「後手中の後手」』より                                | 東京03 Official YouTube Channel    |
|       1 | 【暴走する子ども】次々と人々を襲い息の根を止めていく子ども                                           | MANARUTAIマナル隊                    |
|       1 | プラスチックを簡単に修復するライフハック。                                                   | 佐賀よかでしょう。                        |
|       1 | 暴落しすぎて、ありえない値段でたたき売られてる『高級ホタテ』を救いたい。                                    | きまぐれクックKimagure Cook             |
|       2 | ４時間撮影した後も全力で遊び続けるフィッシャーズがこちら                                            | Fischer’s-セカンダリ-                 |
|       2 | ５０年前の幻のバイクを簡単メンテナンス！                                                    | 佐賀よかでしょう。                        |
|       2 | 『ストマックの日常』41話　医者も見捨てた末期のギャンブル依存症男　末期のアル中男　　2020年　天皇賞春　への切符を賭けた熱き戦い編     | ストマック                            |
|       2 | 【アマゾン】超巨大レバーでワニを召喚して釣る                                               | ハイサイ探偵団                          |
|       2 | ヘイお待ち！サッポロ一番みそラーメンに一手間加えて大勝利してみた【税込み500円】                               | ヒカル（Hikaru）                      |
|       2 | ２本の竿でアマゾンの殺人ワニを釣り上げろ                                                 | ハイサイ探偵団                          |
|       2 | 深海１０００メートルに生息する『幻のキンメダイ』が手に入った！意外過ぎるお味に驚愕                               | きまぐれクックKimagure Cook             |
|       2 | 「TAKERU NO PLAN DRIVE」\#5                                               | 佐藤 健 / Satoh Takeru              |
|       2 | 【閲覧注意】内臓だらけな一人焼肉～アレとアレとアレとアレの盛り合わせ～                                     | /谷やん谷崎鷹人                         |
|       2 | 【悲報】新iPhone SE全色自分ごと水没！４万円台で買えるコスパ抜群のiphone\!【開封レビュー】【カメラ比較】【ヒカキンTV】 | HikakinTV                        |
|       3 | 【全員集合！✨】お知らせがございます！！！！！【すとぷり】                                           | すとぷりちゃんねる                        |
|       3 | 裏庭の木の中で子育てする野鳥を発見！！                                                     | 佐賀よかでしょう。                        |
|       3 | 【お知らせ‼︎】チャンネルメンバーシップについて                                                | SUSHI RAMEN【Riku】                |
|       3 | 【爆笑】9年前にフィッシャーズが迷作映画を作ってました。                                            | Fischer’s-フィッシャーズ-               |
|       3 | 【実況パワフルプロ野球】ヤシロ&ササキのレバガチャダイパン \#3【にじさんじ】                                | にじさんじ                            |
|       3 | 【番長２】よしきが愛して止まないこの一台！【よしきの成り上がり人生録　家スロver\#1】\[パチスロ\]\[スロット\]           | スロパチステーション                       |
|       3 | 【報告】まやりん第一子おめでとう！！                                                      | \#まなまやチャンネル                      |
|       4 | 【衝撃】メンバーにいきなり電話で告白してみたら…？                                               | 48-フォーエイト                        |
|       4 | 【確定役８連発】やっぱりGODは楽しいと思える最高の実践がこちら【黒っす】                                   | IMCいむちゃんねる                       |
|       4 | 【丸一日】大人が本気でダンボールハウスを家に作ってみたwwww【2LDK】                                   | 水溜りボンド                           |
|       4 | No.27 【ご報告】作業部屋のアレクサを捨てようと思いましたが、考え直します。                                | こんびにこ                            |
|       4 | 【未知】世にも奇妙なボリビアの人の怪魚捌き【パクー】                                           | ハイサイ探偵団                          |
|       4 | ボートレース【ういちの江戸川ナイスぅ〜っ！】\#060 ３万舟は誰が獲った！？                                 | ボートレース江戸川公式チャンネル ういちの江戸川ナイスぅ〜っ\! |
|       4 | 世界最大の蛇の大きさがおかしい件について【アマゾン遠征EP2 \#9】                                     | ハイサイ探偵団                          |
|       4 | 「TAKERU NO PLAN DRIVE」\#4                                               | 佐藤 健 / Satoh Takeru              |
|       5 | Twitterで超バズった「日本クリエイター本気の島」行ってみたらヤバすぎた！！【どうぶつの森】                        | 水溜りボンド                           |
|       5 | EXILE TAKAHIRO「Message」リリックビデオ                                          | LDH JAPAN                        |
|       5 | やめます                                                                    | ジャックポット.                         |
|       5 | No.29　お節介アレクサが退職願出してきた。                                                 | こんびにこ                            |

近年話題のプレイ動画などが含まれる`Gaming`についても同様に。

| minrank | title                                                      | ctitle             |
| ------: | :--------------------------------------------------------- | :----------------- |
|       1 | 【ヒカクラ2】Part32 - まさかの自宅襲撃…ヒカキン村を守れ\!\!\!【マインクラフト】【ヒカキンゲームズ】 | HikakinGames       |
|       1 | マインクラフト～ハードコアエンダードラゴン討伐WITH後輩～                             | jun channel        |
|       2 | 【フォートナイト】寝起きでプレイしたらついにビクロイか\!?【ヒカキンゲームズ】                   | HikakinGames       |
|       2 | 【青鬼オンライン】青の塔登場！5階が青鬼だらけでヒカキン発狂www【ヒカキンゲームズ】                | HikakinGames       |
|       3 | 謝罪　桜鷹虎                                                     | 桜鷹虎〈さくらたかとら〉       |
|       3 | \#6【マイクラ脱獄】もしかして、都市伝説の人?【日常組】                              | 日常組                |
|       3 | プロスピA対決動画 北海道日本ハムファイターズ篇（金子選手・宮西選手・大田選手・西川選手） 2020年度版      | パワプロ・プロスピ公式チャンネル   |
|       3 | １８日目 「小野賢章の島 その２」【あつまれ どうぶつの森】                             | 花江夏樹               |
|       3 | 最強のクルマガチャ対決で大当たりが出た！【マインクラフト・まいくら・マイクラ】                    | まいぜんシスターズ          |
|       4 | モンストニュース\[4/30\]モンストの最新情報をお届けします！【モンスト公式】                  | モンスト（モンスターストライク）公式 |
|       4 | 【4人実況】日本で誰も遊んでない即死だらけの笑えるゲーム『 QUEST ROOMS 』                | キヨ。                |
|       5 | あの日、泣きついてしまった小笠原さんを救いたい。                                   | ダルビッシュのゲームチャンネル    |

`Entertainment`と`Gaming`を比較するのも面白いでしょう
（トレンドの動画の数と“特に”トレンドの動画の数の割合が一致しない理由を考えるなど）。

### カテゴリの関係（しません）

各カテゴリの関係をチャンネルの観点から見つけます。
ここでは条件付き確率\\(p(c\_{i}|c\_{j})=p(c\_{i},c\_{j})/p(c\_{i})\\)
を求めます。ここで\\(c\_{i}\\)は\\(i\\)番目カテゴリを、\\(p(c\_{i})\\)はあるチャンネルがカテゴリ
\\(c\_{i}\\)の動画をアップロードしている確率を、さらに、\\(p(c\_{i},c\_{j})\\)は
あるチャンネルがカテゴリ\\(c\_{i}\\)の動画とカテゴリ\\(c\_{j}\\)の動画をアップロードしている確率を
表します。

と思いましたが、1873個のチャンネルのうち、異なるカテゴリの動画を アップロードしているものは43個
しかなかったので、もう少し集まってから試してみたいと思います。

### サムネイルに顔が載っている動画について

ここからが本題です。最終目標は日本語版VoxCeleb的なデータセットの作成で、
効率的な収集のために、顔が映っている動画を優先的に処理することが不可欠です。

これを実現するひとつの方法として、サムネイルに顔が載っている動画、および
そのような動画をアップロードしているチャンネルの動画のリストアップを考えました。

ここでは、収集したメタデータをもとに、サムネイルに顔が映っている動画がどれくらいの 割合であるのか調べます。

#### 基本

サムネイルに顔が映っている動画は 3060本中 1119本で、 その割合は36.5686275%。

また、顔が写っている動画がアップロードされているチャンネルは、全1873チャンネル中、 863チャンネルで、 その割合は46.0758142%。

#### カテゴリごとに

次のコマンドでカテゴリごとの顔含有数の図を描画します。

``` r
data %>%
    select(c(id, cattitle, nfaces)) %>%
    distinct() %>%
    mutate(has_face = nfaces > 0) %>%
    ggplot(aes(x = cattitle, fill = has_face)) +
    geom_bar() +
    scale_fill_viridis(discrete = TRUE, begin = 0.3, end = 0.7) +
    theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
```

![](/assets/img/youtuberer/day-3-fig-2-1.png)<!-- -->

`Pets & Animals`の含有率が極端に低いのですが、人間載せても意味ないから当たり前か。

### まとめと次回予告

1000本を超える顔画像サムネイル動画と、およそ900個のチャンネルが見つかったので、
引き続き、全体のメタデータの収集を進めつつ、分析対象の動画の選定に移ります。
